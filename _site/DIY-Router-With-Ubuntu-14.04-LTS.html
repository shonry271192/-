<!DOCTYPE html>
<html>

<head>
	<!-- Meta -->
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
	<meta name="generator" content="Jekyll">

	<title>DIY Router With Ubuntu 14.04 LTS</title>

	<!-- CSS & fonts -->
	<link rel="stylesheet" href="/kevydotvinu.github.io/css/main.css">
	<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,900,400italic%7CSignika:700,300,400,600' rel='stylesheet' type='text/css'>

	<!-- RSS -->
	<link href="/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" />

</head>


<body>
	<div id="wrap">
	  	
	  	<!-- Navigation -->
	  	<nav id="nav">
	<div id="nav-list">
		<a href="/kevydotvinu.github.io">Home</a>

		<!-- Nav pages -->
	  
	    
	  
	    
	      <a href="/kevydotvinu.github.io/about" title="About Me">About Me</a>
	    
	  
	    
	  
	    
	      <a href="/kevydotvinu.github.io/contact" title="Contact">Contact</a>
	    
	  
	    
	  
	    
	  
    
    <!-- Nav links -->
	  <a href="https://github.com/kevydotvinu/">GitHub</a>
<a href="https://askubuntu.com/users/367967/vinu-kevy">AskUbuntu</a>

	</div>
  
  <!-- Nav footer -->
	
	  <footer>
	
	<span>linuxmate</span>

</footer>
	

</nav>

    
    <!-- Icon menu -->
	  <a id="nav-menu">
	  	<div id="menu"></div>
	  </a>

      <!-- Header -->
      
        <header id="header">
	<a href="/kevydotvinu.github.io">
<img src="/kevydotvinu.github.io/img/downarrow.svg" alt="Emerald Logo">
                <h1>linux<h9>mate</h9></h1>
		<h8>A typical Linux blog</h8>	  
	</a>
</header>

      

    <!-- Main content -->
	  <div id="container">
		  
		<main>

			<article id="post-page">
	<h2>DIY Router With Ubuntu 14.04 LTS</h2>		
	<time datetime="2017-06-18T00:00:00+05:30" class="by-line">18 Jun 2017</time>
	<div class="content">

		<p>I have been using Ubuntu as my base machine for the past some years. Things have been learning from day to day since then. Recently, my thoughts have crossed the internals of routers and which turned out to be the idea of Ubuntu as a router. You would be wondering why do we need Ubuntu as a router when we have ready-made one? Assume that, we are living in a town like Mumbai where ISP provide DSL connections to the whole apartment through a switch installed on the top of it. In that case, we don’t have to pay for router or something when we get connected like plugged in directly to the PC or laptop. This scenario makes to think “Linux as a router” if you love and explore the possibilities of Linux. All we have to need is two LAN card or in my case, second one is WLAN as a Wireless Access Point. Wireless Access Point provide internet as well as IP address from the configured DHCP server which I have installed in my machine. Following are the needful.</p>

<ul>
  <li>DHCP Server</li>
  <li>Hostapd</li>
  <li>IPtable Configuration</li>
  <li>Switch Linux as Router</li>
  <li>Configure Network</li>
</ul>

<h3 id="dhcp-server">DHCP Server</h3>

<blockquote>
  <p>sudo apt-get install dnsmasq</p>
</blockquote>

<blockquote>
  <p>sudo vim /etc/dnsmasq.conf</p>
</blockquote>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre><span class="nv">interface</span><span class="o">=</span>wlan0
dhcp-range<span class="o">=</span>10.0.0.2,10.0.0.14,12h<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h3 id="hostapd">Hostapd</h3>

<blockquote>
  <p>sudo apt-get install hostapd</p>
</blockquote>

<blockquote>
  <p>sudo vim /etc/default/hostapd.conf</p>
</blockquote>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="nv">DAEMON_CONF</span><span class="o">=</span><span class="s2">"/etc/hostapd/hostapd.conf"</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<blockquote>
  <p>sudo nano /etc/hostapd/hostapd.conf</p>
</blockquote>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre></td><td class="code"><pre><span class="nv">auth_algs</span><span class="o">=</span>1
<span class="nv">beacon_int</span><span class="o">=</span>50
<span class="nv">channel</span><span class="o">=</span>3
<span class="nv">country_code</span><span class="o">=</span>US
<span class="nv">disassoc_low_ack</span><span class="o">=</span>1
<span class="nv">driver</span><span class="o">=</span>nl80211
<span class="nv">hw_mode</span><span class="o">=</span>g
<span class="nv">ht_capab</span><span class="o">=[</span>HT40+][HT40-][SHORT-GI-40][RX-STBC1]
<span class="nv">ieee80211d</span><span class="o">=</span>1
<span class="nv">ieee80211n</span><span class="o">=</span>1
<span class="nv">interface</span><span class="o">=</span>wlan0
<span class="nv">require_ht</span><span class="o">=</span>0
<span class="nv">rsn_pairwise</span><span class="o">=</span>CCMP
<span class="nv">ssid</span><span class="o">=</span>YOURSSID
<span class="nv">wmm_enabled</span><span class="o">=</span>1
<span class="nv">wpa</span><span class="o">=</span>2
<span class="nv">wpa_key_mgmt</span><span class="o">=</span>WPA-PSK
<span class="nv">wpa_passphrase</span><span class="o">=</span>YOURPASSPHASE<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h3 id="iptables">IPtables</h3>

<blockquote>
  <p>sudo nano /etc/rc.local</p>
</blockquote>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre>iptables -t nat -A POSTROUTING <span class="se">\</span>
-o wlan1 -j MASQUERADE
iptables -A FORWARD -m conntrack <span class="se">\</span>
--ctstate RELATED,ESTABLISHED -j ACCEPT
iptables -A FORWARD <span class="se">\</span>
-i wlan0 -o wlan1 -j ACCEPT
<span class="nb">exit </span>0<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h3 id="switch-linux-as-router">Switch Linux as router</h3>

<blockquote>
  <p>sudo nano /etc/sysctl.conf</p>
</blockquote>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>net.ipv4.ip_forward<span class="o">=</span>1
net.ipv6.conf.all.forwarding<span class="o">=</span>1<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h3 id="configure-network">Configure Network</h3>

<blockquote>
  <p>sudo nano /etc/network/interfaces</p>
</blockquote>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9</pre></td><td class="code"><pre>auto lo wlan0
iface lo inet loopback
<span class="c">#access point</span>
iface wlan0 inet static
address 10.0.0.1
netmask 255.255.255.240
gateway 10.0.0.1
dns-nameservers 192.168.1.1
wireless-mode Master<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<blockquote>
  <p>sudo nano /etc/NetworkManager/NetworkManager.conf</p>
</blockquote>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre><span class="o">[</span>keyfile]
unmanaged-devices<span class="o">=</span>mac:XX:XX:XX:XX:XX:XX<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>


		
	</div>
</article>



	  </main>
		
		  <!-- Pagination links -->
      

	  </div>
	    
	    <!-- Footer -->
	    <footer><span>© 2017 linuxmate</span></footer>

	    <!-- Script -->
      <script src="/kevydotvinu.github.io/js/main.js"></script>	


	</div>
</body>
</html>
